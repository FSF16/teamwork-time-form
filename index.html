<!DOCTYPE html>
<html>
<head>
  <title>Log Time</title>
</head>
<body>
  <h2>Log Time for Teamwork Project</h2>

  <form id="timeForm">
    <input type="hidden" id="project" name="project">

    <label>Date:</label><br>
    <input type="date" id="date" required><br><br>

    <label>Hours to log:</label><br>
    <input type="number" id="hours" min="0.1" step="0.1" required><br><br>

    <button type="submit">Submit</button>
  </form>

  <script>
    const params = new URLSearchParams(window.location.search);
    document.getElementById("project").value = params.get("project");

    document.getElementById("timeForm").addEventListener("submit", async (e) => {
      e.preventDefault();

      const project = document.getElementById("project").value;
      const date = document.getElementById("date").value;
      const hours = Number(document.getElementById("hours").value);

      const endTime = new Date();
      const startTime = new Date(endTime.getTime() - hours * 60 * 60 * 1000);

      const payload = {
        project,
        date,
        hours,
        startTime: startTime.toISOString(),
        endTime: endTime.toISOString()
      };

      await fetch("https://hook.eu2.make.com/0q05ibp52ws4rwa4xm4nvu9utl48ki1s", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
      });

      alert("Time sent to Make.com âœ…");
    });
  </script>
</body>
</html>
